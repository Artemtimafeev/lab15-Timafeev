# Лабораторная работа 15
## Моделирование ML-проектов в Engee
## Классификация качества красного вина

### Цель работы
Разработать модель классификации на платформе Engee для предсказания качества красного вина по химическим показателям.

### Используемые данные
- Датасет: Wine Quality (Red Wine)
- Источник: UCI Machine Learning Repository
- Размер: 1599 образцов, 12 признаков
- Признаки: фиксированная кислотность, летучая кислотность, лимонная кислота и др.
- Целевая переменная: quality (качество от 3 до 8 баллов)
- Тип задачи: многоклассовая классификация (6 классов)

### Ход работы

#### 1. Загрузка данных в Engee
- Файл `winequality-red.csv` загружен в облачную среду Engee
- Данные проверены на целостность и отсутствие пропусков

#### 2. Предобработка данных
- Целевая переменная преобразована в категориальную
- Данные разделены на обучающую (80%) и тестовую (20%) выборки
- Стратификация по целевому признаку для сохранения распределения классов

#### 3. Обучение модели
- Выбран алгоритм: Random Forest Classifier
- Параметры по умолчанию: 100 деревьев
- Обучение проведено в среде Engee с использованием Julia/MLJ

#### 4. Оценка модели
- Метрика: Accuracy (точность)
- Результат: 66.98% на тестовой выборке

### Результаты

#### Матрица ошибок:
text
      ┌───────────────────────┐
      │     Ground Truth      │
┌─────────┼───┬───┬───┬───┬───┬───┤
│Predicted│ 3 │ 4 │ 5 │ 6 │ 7 │ 8 │
├─────────┼───┼───┼───┼───┼───┼───┤
│ 3 │ 0 │ 0 │ 0 │ 0 │ 0 │ 0 │
├─────────┼───┼───┼───┼───┼───┼───┤
│ 4 │ 0 │ 0 │ 0 │ 0 │ 0 │ 0 │
├─────────┼───┼───┼───┼───┼───┼───┤
│ 5 │ 2 │ 7 │101│37 │ 0 │ 0 │
├─────────┼───┼───┼───┼───┼───┼───┤
│ 6 │ 0 │ 4 │35 │87 │21 │ 1 │
├─────────┼───┼───┼───┼───┼───┼───┤
│ 7 │ 0 │ 0 │ 0 │ 4 │18 │ 2 │
├─────────┼───┼───┼───┼───┼───┼───┤
│ 8 │ 0 │ 0 │ 0 │ 0 │ 1 │ 1 │
└─────────┴───┴───┴───┴───┴───┴───┘

text

#### Анализ результатов:
- Наибольшая точность для классов 5 и 6 (наиболее представленных в данных)
- Классы 3 и 4 почти не распознаются из-за малого количества образцов
- Основные ошибки — смешение соседних классов (5↔6, 6↔7)

### Ключевой код

julia
# Основные этапы работы
```
using CSV, DataFrames, MLJ
```
# Загрузка и подготовка данных
```
df = CSV.read("winequality-red.csv", DataFrame; delim=';')
df.quality = categorical(df.quality)
```
# Разделение на train/test
```
train_indices, test_indices = partition(eachindex(df.quality), 0.8, 
```                          ```              stratify=df.quality, rng=42)
```
# Обучение Random Forest
```
RandomForestClassifier = @load RandomForestClassifier pkg=DecisionTree
model = RandomForestClassifier()
mach = machine(model, X_train, y_train)
fit!(mach)
```

# Оценка
```
y_pred = predict_mode(mach, X_test)
accuracy = accuracy(y_pred, y_test)  # 0.6698 (66.98%)
```
# Сохранение модели
```
using JLD2
@save "wine_quality_classifier.jld2" mach
```